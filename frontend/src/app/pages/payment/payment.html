<div class="payment-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Loading payment details...</p>
  </div>

  <!-- Payment Form -->
  <div *ngIf="!isLoading" class="payment-card">
    <div class="payment-header">
      <h1>Complete Your Payment</h1>
      <p>Secure payment powered by Stripe</p>
    </div>

    <!-- Order Summary -->
    <div class="order-summary" *ngIf="orderDetails">
      <h3>Order Summary</h3>
      <div class="summary-row">
        <span>Order ID:</span>
        <span><strong>#{{ orderId }}</strong></span>
      </div>
      <div class="summary-row">
        <span>Items:</span>
        <span>{{ orderDetails.items?.length || 0 }} items</span>
      </div>
      <div class="summary-row total">
        <span>Total Amount:</span>
        <span><strong>â‚¹{{ (orderDetails.total || orderDetails.totalAmount)?.toFixed(2) }}</strong></span>
      </div>
    </div>

    <!-- Payment Method Selection removed (Razorpay modal handles it) -->

    <!-- Payment Details with Amount Split-up -->
    <div class="payment-form" *ngIf="orderDetails">
      <h3>Payment Details</h3>
      <div class="order-summary">
        <div class="summary-row">
          <span>Subtotal:</span>
          <span>â‚¹{{ (orderDetails.subtotal || 0) | number:'1.2-2' }}</span>
        </div>
        <div class="summary-row">
          <span>GST:</span>
          <span>â‚¹{{ (orderDetails.tax || 0) | number:'1.2-2' }}</span>
        </div>
        <div class="summary-row">
          <span>Delivery Fee:</span>
          <span>â‚¹{{ (orderDetails.deliveryFee || 0) | number:'1.2-2' }}</span>
        </div>
        <div class="summary-row total">
          <span>Total:</span>
          <span>â‚¹{{ (orderDetails.total || orderDetails.totalAmount) | number:'1.2-2' }}</span>
        </div>
      </div>
      <p class="secure-note">ðŸ”’ Your payment details are secure and encrypted</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="error-message" role="alert">
      {{ errorMessage }}
    </div>

    <!-- Success Message -->
    <div *ngIf="successMessage" class="success-message" role="alert">
      âœ… {{ successMessage }}
    </div>

    <!-- Submit Button -->
    <button 
      type="button"
      class="btn btn-primary btn-full"
      [disabled]="isProcessing || !orderDetails"
      (click)="submitPayment()">
      <span *ngIf="!isProcessing">Pay â‚¹{{ (orderDetails?.total || orderDetails?.totalAmount)?.toFixed(2) }}</span>
      <span *ngIf="isProcessing">Processing...</span>
    </button>

    <!-- Security Badges -->
    <div class="security-badges">
      <span class="badge">ðŸ”’ SSL Secured</span>
      <span class="badge">âœ“ PCI Compliant</span>
    </div>
  </div>
</div>
